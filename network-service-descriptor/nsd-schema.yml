---
  $schema: "http://json-schema.org/draft-04/schema#"
  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive"
  description: "The core scheme for RECUSRIVE service descriptors (many details left out)"
  type: "object"
  properties:
    descriptor_version:
      description: "The version of the description definition used to describe the network descriptor."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/descriptor_version"
      type: "string"
      pattern: "^[A-Za-z0-9\\-_.]+$"
    ns_group:
      description: "The group id identifies the NS descriptor uniquely across all network descriptors."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/ns_group"
      type: "string"
      pattern: "^[a-z0-9\\-_.]+$"
    ns_name: 
      description: "The name of the network service description."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/ns_name"
      type: "string"
      pattern: "^[a-z0-9\\-_.]+$"
    ns_version: 
      description: "The version of the service descriptor."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/ns_version"
      type: "string"
      pattern: "^[0-9\\-_.]+$"
    ns_author:
      description: "The person or organization that created the NS descriptor."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/ns_author"
      type: "string"
    ns_description:
      description: "A longer description of the network service."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/ns_description"
      type: "string"
    network_functions: 
      description: "The VNFs (their descriptors), that are part of this network service."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/network_functions"
      type: "array"
      items: 
        id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/network_functions/0"
        type: "object"
        properties:
          vnf_id:
            description: "A unique identifier of this network function within the scope of this NS descriptor."
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/network_functions/0/vnf_id"
            type: "string"
          vnf_group:
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/network_functions/0/vnf_group"
            type: "string"
          vnf_name:
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/network_functions/0/vnf_name"
            type: "string"
          vnf_version:
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/network_functions/0/vnf_version"
            type: "string"
          description:
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/network_functions/0/description"
            type: "string"
        required:
          - vnf_id
          - vnf_group
          - vnf_name
          - vnf_version
        additionalProperties: false
      minItems: 1
      uniqueItems: true
    network_services:
      description: "The recursive NSs (their descriptors), that are part of this network service."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/network_services"
      type: "array"
      items: 
        type: "string"
      minItems: 0
      uniqueItems: true
      # how do I write down that there must be at least one of VNFDs or NSDs?
    forwarding_graph:
      description: "The forwarding graph."
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph"
      type: "object"
      oneOf:
        - description: "A reference to a forwarding graph description."
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd_ref"
          type: "object"
          properties:
            fg_id:
              description: "A unique identifier of this forwarding graph within the scope of this NS descriptor."
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd_ref/fg_id"
              type: "string"
            group: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd_ref/group"
              type: "string"
            name:
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd_ref/name"
              type: "string"
            version:
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd_ref/version"
              type: "string"
            description:
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd_ref/version"
              type: "string"
          required:
            - fg_id
            - group
            - name
            - version
          additionalProperties: false
        - description: "A full-featured forwarding graph description."
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd"
          type: "object"
          properties:
            fg_id:
              description: "A unique identifier of this forwarding graph within the scope of this NS descriptor."
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/fg_id"
              type: "string"
            number_of_endpoints: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/number_of_endpoints"
              type: "integer"
            number_of_virtual_links: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/number_of_virtual_links"
              type: "integer"
            depedent_virtual_links: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/depedent_virtual_links"
              type: "array"
              items: 
                - id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/depedent_virtual_links/0"
                  type: "string"
            network_forwarding_path: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path"
              type: "array"
              items: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0"
                type: "object"
                properties: 
                  nfp_id: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/nfp_id"
                    type: "string"
                  graph: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/graph"
                    type: "array"
                    items: 
                      - id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/graph/0"
                        type: "string"
                  connection_points: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/connection_points"
                    type: "array"
                    items: 
                      - id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/connection_points/0"
                        type: "string"
                  constituent_vnfs: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/constituent_vnfs"
                    type: "array"
                    items: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/constituent_vnfs/0"
                      type: "string"
                  constituent_services: 
                    id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/constituent_services"
                    type: "array"
                    items: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/forwarding_graph/fgd/network_forwarding_path/0/constituent_services/0"
                      type: "string"
          required:
            - id
    lifecycle_events: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events"
      type: "object"
      properties: 
        start: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/start"
          type: "array"
          items: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/start/0"
            type: "object"
            properties: 
              vnf_id: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/start/0/vnf_id"
                type: "string"
              vnf_event: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/start/0/vnf_event"
                type: "string"
        stop: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/stop"
          type: "array"
          items: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/stop/0"
            type: "object"
            properties: 
              vnf_id: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/stop/0/vnf_id"
                type: "string"
              vnf_event: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/stop/0/vnf_event"
                type: "string"
        scale_out: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/scale_out"
          type: "array"
          items: 
            id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/scale_out/0"
            type: "object"
            properties: 
              vnf_id: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/scale_out/0/vnf_id"
                type: "string"
              vnf_event: 
                id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/lifecycle_events/scale_out/0/vnf_event"
                type: "string"
    vnf_depedency: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vnf_depedency"
      type: "array"
      items: 
        type: "string"
      minItems: 0
      uniqueItems: true
    services_depedency: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/services_depedency"
      type: "array"
      items: 
        type: "string"
      minItems: 0
      uniqueItems: true
    monitoring_parameters: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters"
      type: "array"
      items: 
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/0"
          type: "object"
          properties: 
            desc: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/0/desc"
              type: "string"
            metric: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/0/metric"
              type: "string"
            unit: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/0/unit"
              type: "string"
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/1"
          type: "object"
          properties: 
            desc: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/1/desc"
              type: "string"
            metric: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/1/metric"
              type: "string"
            unit: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/monitoring_parameters/1/unit"
              type: "string"
    vld: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld"
      type: "object"
      properties: 
        id: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/id"
          type: "string"
        vendor: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vendor"
          type: "string"
        manifest_file_md5: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/manifest_file_md5"
          type: "string"
        number_of_endpoints: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/number_of_endpoints"
          type: "integer"
        virtual_links: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links"
          type: "array"
          items: 
            - 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0"
              type: "object"
              properties: 
                vld_id: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/vld_id"
                  type: "string"
                root_requirements: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/root_requirements"
                  type: "string"
                leaf_requirements: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/leaf_requirements"
                  type: "string"
                qos: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/qos"
                  type: "object"
                  properties: 
                    none: 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/qos/none"
                      type: "string"
                test_access: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/test_access"
                  type: "string"
                connections: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/connections"
                  type: "array"
                  items: 
                    - 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/connections/0"
                      type: "string"
                    - 
                      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/connections/1"
                      type: "string"
                connectivity_type: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/vld/vitual_links/0/connectivity_type"
                  type: "string"
    auto_scale_policy: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy"
      type: "object"
      properties: 
        criteria: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria"
          type: "array"
          items: 
            - 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria/0"
              type: "object"
              properties: 
                end-to-end bandwidth: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria/0/end-to-end_bandwidth"
                  type: "string"
            - 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria/1"
              type: "object"
              properties: 
                test: 
                  id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/criteria/1/test"
                  type: "string"
        action: 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/auto_scale_policy/action"
          type: "string"
    connection_points: 
      id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points"
      type: "array"
      items: 
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/0"
          type: "object"
          properties: 
            connection_point_id: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/0/connection_point_id"
              type: "string"
            type: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/0/type"
              type: "string"
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/1"
          type: "object"
          properties: 
            connection_point_id: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/1/connection_point_id"
              type: "string"
            type: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/1/type"
              type: "string"
        - 
          id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/2"
          type: "object"
          properties: 
            connection_point_id: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/2/connection_point_id"
              type: "string"
            type: 
              id: "http://www.sonata-nfv.eu/schema/nsd-schema-02-recursive/connection_points/2/type"
              type: "string"
  required: 
    - descriptor_version
    - ns_group
    - ns_name
    - ns_version

